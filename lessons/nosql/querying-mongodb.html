<!DOCTYPE html><html><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png" data-next-head=""/><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png" data-next-head=""/><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png" data-next-head=""/><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png" data-next-head=""/><link rel="icon" type="image/x-icon" href="/images/favicon.ico" data-next-head=""/><title data-next-head="">Querying Mongodb – Complete Intro to Databases v2</title><meta name="description" content="After inserting documents into MongoDB, you are going to want to be able to query those documents. Brian shows you how in this section to write find queries for MongoDB." data-next-head=""/><meta name="keywords" content="postgres,sql,redis,mongodb,neo4j,database,data,agents" data-next-head=""/><meta name="og:description" content="After inserting documents into MongoDB, you are going to want to be able to query those documents. Brian shows you how in this section to write find queries for MongoDB." data-next-head=""/><meta name="og:title" content="Querying Mongodb – Complete Intro to Databases v2" data-next-head=""/><meta name="og:image" content="/images/social-share-cover.jpg" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><link data-next-font="size-adjust" rel="preconnect" href="/" crossorigin="anonymous"/><link rel="preload" href="/_next/static/chunks/3802a39ca373f962.css" as="style"/><link rel="stylesheet" href="/_next/static/chunks/3802a39ca373f962.css" data-n-g=""/><noscript data-n-css=""></noscript><script src="/_next/static/chunks/dbe15a90055bd265.js" defer=""></script><script src="/_next/static/chunks/49c75c2ed6206f46.js" defer=""></script><script src="/_next/static/chunks/da0ff8adaa6cce90.js" defer=""></script><script src="/_next/static/chunks/turbopack-342361b32f83e6b6.js" defer=""></script><script src="/_next/static/chunks/f189af6b04c7fd39.js" defer=""></script><script src="/_next/static/chunks/turbopack-8b35dea75ba6f85c.js" defer=""></script><script src="/_next/static/Ogv8p-BwCHRQ1PzRpAU9u/_ssgManifest.js" defer=""></script><script src="/_next/static/Ogv8p-BwCHRQ1PzRpAU9u/_buildManifest.js" defer=""></script></head><body><script async="" defer="" src="https://a.holt.courses/latest.js"></script><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><div id="__next"><link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&amp;display=swap" rel="stylesheet"/><div class="remix-app"><header class="navbar"><h1 class="navbar-brand"><a href="/">Complete Intro to Databases v2</a></h1><div class="navbar-info"><a href="https://frontendmasters.com/workshops/databases-v2/" class="cta-btn">Watch on Frontend Masters</a></div></header><div class="content-container"><div class="main"><div class="lesson-container"><div class="lesson"><div class="lesson-content"><p>So now that we&#39;ve put a lot of documents into our database, it&#39;s time to query our database to get information out of it. There are a variety of reasons and methods you can query a database. You could be querying a database to get one a specific record, like if you&#39;re querying for a user object to show a profile page, or you could be querying for a bunch of things at once, like if a user was searching for pets and you wanted to show five results.</p>
<h2>findOne</h2>
<p>Let&#39;s start with basic querying. Run this in the console.</p>
<pre><code class="hljs language-javascript">db.<span class="hljs-property">pets</span>.<span class="hljs-title function_">findOne</span>();
</code></pre><p>This will go out and find the first item in the database that matches your query and return that. In this case we didn&#39;t give it a query which is the same as saying &quot;give me anything.&quot; You&#39;ll probably get back the first item you inserted into your database which in my case is going to be a Havanese dog named Luna.</p>
<p>Okay, so let&#39;s we want to find the 1337 item we put in the database. Try this:</p>
<pre><code class="hljs language-javascript">db.<span class="hljs-property">pets</span>.<span class="hljs-title function_">findOne</span>({ <span class="hljs-attr">index</span>: <span class="hljs-number">1337</span> });
</code></pre><p>This will find you one item (of which there is only one anyway) where the index is equal to 1337. Okay, one more, let&#39;s find one where it&#39;s a dog named Spot.</p>
<pre><code class="hljs language-javascript">db.<span class="hljs-property">pets</span>.<span class="hljs-title function_">findOne</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Spot&quot;</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;dog&quot;</span> });
</code></pre><h2>find</h2>
<p>So far we&#39;ve only been looking at finding one record at time. If you want to find all documents that match your query, you&#39;ll have to use find instead of findOne. Let&#39;s try it.</p>
<pre><code class="hljs language-javascript">db.<span class="hljs-property">pets</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;dog&quot;</span> });
</code></pre><p>Notice this only giving you twenty results. What MongoDB does by default is only hand you twenty results at a time in the form of what&#39;s called an <strong>iterator</strong> or a <strong>cursor</strong>. An iterator will give you twenty records at a time and allow you to iterate over your results. Frequently this is a useful pattern because you could in theory want to iterate over your whole collection and this allows you to do it piece by piece.</p>
<p>Try iterating now. Run this:</p>
<pre><code>it
it
it
</code></pre><p>You&#39;ll notice that you&#39;re getting twenty different records each time. <code>it</code> will tell your iterator that you want it to iterate again on the last iterator you queried for.</p>
<h2>count, limit, and toArray</h2>
<p>Okay, so let&#39;s try this:</p>
<pre><code class="hljs language-javascript">db.<span class="hljs-property">pets</span>.<span class="hljs-title function_">count</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;dog&quot;</span> }); <span class="hljs-comment">// probably pretty big number</span>
db.<span class="hljs-property">pets</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;dog&quot;</span> }).<span class="hljs-title function_">limit</span>(<span class="hljs-number">40</span>);
it; <span class="hljs-comment">// after this the cursor will end</span>
</code></pre><p><code>count</code> lets you figure our how many of something there are. <code>limit</code> lets the cursor know when you want to stop. But what if you just want to get everything all at once? Try <code>toArray</code></p>
<pre><code class="hljs language-javascript">db.<span class="hljs-property">pets</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;dog&quot;</span> }).<span class="hljs-title function_">limit</span>(<span class="hljs-number">40</span>).<span class="hljs-title function_">toArray</span>();
</code></pre><p>This will just dump everything out into an array which is nice if you just want everything all at once. There&#39;s a myriad of other things you can do that determine how the data is returned but you can find those fairly easily when you need them.</p>
<h2>Query operators</h2>
<p>What if we wanted to find all senior-aged cats in our data set? MongoDB will let you do that! Let&#39;s try this</p>
<pre><code class="hljs language-javascript">db.<span class="hljs-property">pets</span>.<span class="hljs-title function_">count</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;cat&quot;</span>, <span class="hljs-attr">age</span>: { <span class="hljs-attr">$gt</span>: <span class="hljs-number">12</span> } });
</code></pre><p>Note you can use these <a href="%5Bgeo%5D:">query operators</a> anywhere you&#39;re providing a query e.g. findOne, find, etc. The ones you&#39;re primarily going to be interested in are</p>
<ul>
<li>$gt - greater than</li>
<li>$gte - greater than or equal to</li>
<li>$lt - less than</li>
<li>$lte - less than or equal to</li>
<li>$eq - equals (usually not necessary)</li>
<li>$ne - not equals</li>
<li>$in - has the value in the array (MongoDB can store arrays and objects too!)</li>
<li>$nin - does not have the value in the array</li>
</ul>
<p>If you wanted to see all Fidos that are not dogs you could do:</p>
<pre><code class="hljs language-javascript">db.<span class="hljs-property">pets</span>.<span class="hljs-title function_">find</span>({
  <span class="hljs-attr">type</span>: { <span class="hljs-attr">$ne</span>: <span class="hljs-string">&quot;dog&quot;</span> },
  <span class="hljs-attr">name</span>: <span class="hljs-string">&quot;Fido&quot;</span>,
});
</code></pre><h2>Logical operators</h2>
<p>Taking it a step further, you can do logical operators as well. Let&#39;s say you want to find birds between 4 and 8 years old</p>
<pre><code class="hljs language-javascript">db.<span class="hljs-property">pets</span>.<span class="hljs-title function_">find</span>({
  <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;bird&quot;</span>,
  <span class="hljs-attr">$and</span>: [{ <span class="hljs-attr">age</span>: { <span class="hljs-attr">$gte</span>: <span class="hljs-number">4</span> } }, { <span class="hljs-attr">age</span>: { <span class="hljs-attr">$lte</span>: <span class="hljs-number">8</span> } }],
});
</code></pre><p>You also have $or, $nor, and $not available to you. Keep in mind that $not and $ne are different. The former is the logical operator and the latter is <code>!==</code>.</p>
<h2>Special operators</h2>
<p>These won&#39;t be useful now but I just wanted to let you know that you can query by type (see if something is a number, array, object, etc.) with $type and you can query if a document has a field or not with $exists.</p>
<p>There&#39;s a bunch more you can do too. MongoDB even has [geospatial operators][geo] so you can query if two points on the globe are close to each other!</p>
<h2>Sorts</h2>
<p>Frequently you&#39;ll need to do different sorts with your queries. Let&#39;s say you&#39;re making a search page for these pets (foreshadowing what we&#39;re about to do!) Maybe the person who searching on your website is a kind soul and looking to adopt some senior dogs. They could say sort by age, descending.</p>
<pre><code class="hljs language-javascript">db.<span class="hljs-property">pets</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;dog&quot;</span> }).<span class="hljs-title function_">sort</span>({ <span class="hljs-attr">age</span>: -<span class="hljs-number">1</span> });
</code></pre><p>The <code>-1</code> means descending and, as you probably guessed, 1 means ascending.</p>
<h2>Projections</h2>
<p>Lastly, to conclude our little lesson querying (there&#39;s still a lot more you can do), let&#39;s talk about projections. The simplest way to use projections is just to limit which fields you return.</p>
<pre><code class="hljs language-javascript">db.<span class="hljs-property">pets</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;dog&quot;</span> }, { <span class="hljs-attr">name</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">breed</span>: <span class="hljs-number">1</span> });
</code></pre><p>The <code>1</code> means &quot;definitely include this&quot;. In thise case, we&#39;re only including name and breed. If you leave something out (like age) then it doesn&#39;t come along for the ride. Notice that <code>_id</code> does come along. If you don&#39;t want that, you have to explictly exclude it</p>
<pre><code class="hljs language-javascript">db.<span class="hljs-property">pets</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;dog&quot;</span> }, { <span class="hljs-attr">name</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">breed</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">_id</span>: <span class="hljs-number">0</span> });
db.<span class="hljs-property">pets</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;dog&quot;</span> }, { <span class="hljs-attr">name</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">breed</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">_id</span>: <span class="hljs-literal">false</span> }); <span class="hljs-comment">// note that true and false work too</span>
</code></pre><p>It also works to just exclude fields which means include everything I haven&#39;t excluded</p>
<pre><code class="hljs language-javascript">db.<span class="hljs-property">pets</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">type</span>: <span class="hljs-string">&quot;dog&quot;</span> }, { <span class="hljs-attr">_id</span>: <span class="hljs-number">0</span> });
</code></pre></div><div class="lesson-links"><a class="prev" href="/lessons/nosql/mongodb">← Previous</a><a class="next" href="/lessons/nosql/updating-mongodb">Next →</a></div></div><div class="details-bg"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="154" height="154" viewBox="0 0 154 154"><defs><clipPath id="clip-path"><rect id="Rectangle_2238" data-name="Rectangle 2238" width="154" height="154" transform="translate(9467 350)" fill="#fff" stroke="#707070" stroke-width="1"></rect></clipPath><clipPath id="clip-corner-image-active"><rect width="154" height="154"></rect></clipPath></defs><g id="corner-image-active" clip-path="url(#clip-corner-image-active)"><g id="Corner-image-active-2" data-name="Corner-image-active" transform="translate(-9467 -350)" clip-path="url(#clip-path)"><path id="Subtraction_34" data-name="Subtraction 34" d="M-3857.365,1740.766h0l-7.07-7.07,12.89-12.89v14.142l-5.818,5.818Zm-14.142-14.142h0l-7.071-7.07,27.033-27.033v14.143l-19.96,19.96Zm-14.143-14.143h0l-7.07-7.069,41.175-41.175v14.142Zm-14.142-14.142h0l-7.07-7.069,55.317-55.317v14.142Zm-14.142-14.142h0l-7.07-7.069,69.459-69.459v14.142Zm-14.142-14.142h0l-7.07-7.069,76.739-76.739h6.862v7.28Zm-14.143-14.143h0l-7.07-7.069,62.6-62.6h14.142Zm-14.142-14.142h0l-7.07-7.069,48.454-48.454h14.142Zm-14.142-14.142h0l-7.07-7.069,34.312-34.312h14.142Zm-14.142-14.142h0l-7.07-7.069,20.17-20.17h14.142Zm-14.142-14.142h0l-7.071-7.071,6.027-6.027h14.144l-13.1,13.1Zm367.24-56.114v-.909l.455.455-.453.453Z" transform="translate(13472.546 -1236.766)" fill="var(--corner-fill)"></path></g></g></svg></div></div></div></div><footer class="footer"><ul class="socials"><li class="social"><a href="https://twitter.com/holtbt"><svg fill="none" height="100%" width="32" xmlns="http://www.w3.org/2000/svg" viewBox="0.254 0.25 500 451.95400000000006"><path d="M394.033.25h76.67L303.202 191.693l197.052 260.511h-154.29L225.118 294.205 86.844 452.204H10.127l179.16-204.77L.254.25H158.46l109.234 144.417zm-26.908 406.063h42.483L135.377 43.73h-45.59z" fill="var(--footer-icons)"></path></svg></a></li><li class="social"><a href="https://bsky.app/profile/brianholt.me"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -3.268 64 68.414" width="38" height="100%"><path fill="var(--footer-icons)" d="M13.873 3.805C21.21 9.332 29.103 20.537 32 26.55v15.882c0-.338-.13.044-.41.867-1.512 4.456-7.418 21.847-20.923 7.944-7.111-7.32-3.819-14.64 9.125-16.85-7.405 1.264-15.73-.825-18.014-9.015C1.12 23.022 0 8.51 0 6.55 0-3.268 8.579-.182 13.873 3.805zm36.254 0C42.79 9.332 34.897 20.537 32 26.55v15.882c0-.338.13.044.41.867 1.512 4.456 7.418 21.847 20.923 7.944 7.111-7.32 3.819-14.64-9.125-16.85 7.405 1.264 15.73-.825 18.014-9.015C62.88 23.022 64 8.51 64 6.55c0-9.818-8.578-6.732-13.873-2.745z"></path></svg></a></li><li class="social"><a href="https://github.com/btholt"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-github-social"><rect width="32" height="32"></rect></clipPath></defs><g id="github-social" clip-path="url(#clip-github-social)"><g id="Group_272" data-name="Group 272" transform="translate(13522.5 -6994)"><path id="Subtraction_33" data-name="Subtraction 33" d="M-24967.5,8041a15.9,15.9,0,0,1-11.312-4.688A15.893,15.893,0,0,1-24983.5,8025a15.893,15.893,0,0,1,4.689-11.315A15.894,15.894,0,0,1-24967.5,8009a15.894,15.894,0,0,1,11.313,4.686A15.893,15.893,0,0,1-24951.5,8025a15.893,15.893,0,0,1-4.689,11.313A15.9,15.9,0,0,1-24967.5,8041Zm-3.781-4.571h0v3.918h7.895v-6.665a1.836,1.836,0,0,0-1.2-1.718c5.1-.617,7.467-2.975,7.467-7.424a7.176,7.176,0,0,0-1.637-4.728,6.74,6.74,0,0,0,.275-1.812,4.34,4.34,0,0,0-.52-2.452.574.574,0,0,0-.359-.1c-1.061,0-3.465,1.411-3.936,1.694a16.644,16.644,0,0,0-4.2-.489,16.379,16.379,0,0,0-3.969.445c-.846-.5-2.91-1.649-3.859-1.649a.566.566,0,0,0-.354.095,4.3,4.3,0,0,0-.521,2.452,6.7,6.7,0,0,0,.244,1.718,7.346,7.346,0,0,0-1.6,4.822,7.263,7.263,0,0,0,1.533,4.985c1.193,1.359,3.115,2.165,5.871,2.464a1.826,1.826,0,0,0-1.129,1.693v.5h0l-.006,0a7.121,7.121,0,0,1-2.033.363,2.608,2.608,0,0,1-.965-.158,4.438,4.438,0,0,1-1.836-1.881,2.361,2.361,0,0,0-1.248-1.091,3.472,3.472,0,0,0-1.217-.3.584.584,0,0,0-.545.224.282.282,0,0,0,.027.367,1.875,1.875,0,0,0,.447.307,4.732,4.732,0,0,1,.561.355,10.726,10.726,0,0,1,1.682,2.755c.043.092.078.163.105.217a3.876,3.876,0,0,0,2.42,1.185,6.036,6.036,0,0,0,.607.025c.875,0,1.988-.124,2-.125Z" transform="translate(11461 -1015)" fill="var(--footer-icons)"></path><g id="Ellipse_670" data-name="Ellipse 670" transform="translate(-13522.5 6994)" fill="none" stroke="var(--footer-icons)" stroke-width="1"><circle cx="16" cy="16" r="16" stroke="none"></circle><circle cx="16" cy="16" r="15.5" fill="none"></circle></g></g></g></svg></a></li><li class="social"><a href="https://linkedin.com/in/btholt"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-linkedin-social"><rect width="32" height="32"></rect></clipPath></defs><g id="linkedin-social" clip-path="url(#clip-linkedin-social)"><g id="Group_270" data-name="Group 270" transform="translate(-86.349 -633.073)"><path id="Path_375" data-name="Path 375" d="M115.789,633.073a2.324,2.324,0,0,1,1.682.676,2.194,2.194,0,0,1,.695,1.627V662.8a2.131,2.131,0,0,1-.695,1.609,2.314,2.314,0,0,1-1.646.659H88.69a2.307,2.307,0,0,1-1.646-.659,2.128,2.128,0,0,1-.695-1.609V635.376a2.19,2.19,0,0,1,.695-1.627,2.322,2.322,0,0,1,1.682-.676h27.063Zm-20.224,9.672a2.561,2.561,0,0,0,0-3.584,2.658,2.658,0,0,0-1.938-.712,2.724,2.724,0,0,0-1.957.712,2.371,2.371,0,0,0-.75,1.792,2.4,2.4,0,0,0,.731,1.792,2.605,2.605,0,0,0,1.9.713h.037A2.7,2.7,0,0,0,95.565,642.745ZM96,645.434H91.213V659.88H96Zm17.3,6.144a7.007,7.007,0,0,0-1.573-4.9,5.68,5.68,0,0,0-6.839-.769,5.663,5.663,0,0,0-1.426,1.573v-2.048H98.674q.036.841,0,7.717v6.728h4.791V651.8a3.592,3.592,0,0,1,.146-1.17,2.913,2.913,0,0,1,.878-1.206,2.429,2.429,0,0,1,1.609-.549,2.108,2.108,0,0,1,1.865.914,4.265,4.265,0,0,1,.549,2.341v7.752H113.3Z" fill="var(--footer-icons)"></path></g></g></svg></a></li><li class="social"><div class="terms"><p>Content Licensed Under CC-BY-NC-4.0</p><p>Code Samples and Exercises Licensed Under Apache 2.0</p><p>Site Designed by<!-- --> <a href="https://www.alexdanielson.com/">Alex Danielson</a></p></div></li></ul><div class="theme-icons"><button aria-label="Activate dark mode" title="Activate dark mode" class="theme-toggle"><svg xmlns="http://www.w3.org/2000/svg" width="36px" height="100%" viewBox="0 -960 960 960" fill="var(--text-footer)" role="img"><title>Dark Mode Icon</title><path d="M480-120q-150 0-255-105T120-480q0-150 105-255t255-105q14 0 27.5 1t26.5 3q-41 29-65.5 75.5T444-660q0 90 63 153t153 63q55 0 101-24.5t75-65.5q2 13 3 26.5t1 27.5q0 150-105 255T480-120Zm0-80q88 0 158-48.5T740-375q-20 5-40 8t-40 3q-123 0-209.5-86.5T364-660q0-20 3-40t8-40q-78 32-126.5 102T200-480q0 116 82 198t198 82Z"></path></svg></button></div></footer></div><noscript><img src="https://a.holt.courses/noscript.gif" alt="" referrerPolicy="no-referrer-when-downgrade"/></noscript></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"attributes":{"description":"After inserting documents into MongoDB, you are going to want to be able to query those documents. Brian shows you how in this section to write find queries for MongoDB."},"html":"\u003cp\u003eSo now that we\u0026#39;ve put a lot of documents into our database, it\u0026#39;s time to query our database to get information out of it. There are a variety of reasons and methods you can query a database. You could be querying a database to get one a specific record, like if you\u0026#39;re querying for a user object to show a profile page, or you could be querying for a bunch of things at once, like if a user was searching for pets and you wanted to show five results.\u003c/p\u003e\n\u003ch2\u003efindOne\u003c/h2\u003e\n\u003cp\u003eLet\u0026#39;s start with basic querying. Run this in the console.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003edb.\u003cspan class=\"hljs-property\"\u003epets\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003efindOne\u003c/span\u003e();\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThis will go out and find the first item in the database that matches your query and return that. In this case we didn\u0026#39;t give it a query which is the same as saying \u0026quot;give me anything.\u0026quot; You\u0026#39;ll probably get back the first item you inserted into your database which in my case is going to be a Havanese dog named Luna.\u003c/p\u003e\n\u003cp\u003eOkay, so let\u0026#39;s we want to find the 1337 item we put in the database. Try this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003edb.\u003cspan class=\"hljs-property\"\u003epets\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003efindOne\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003eindex\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1337\u003c/span\u003e });\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThis will find you one item (of which there is only one anyway) where the index is equal to 1337. Okay, one more, let\u0026#39;s find one where it\u0026#39;s a dog named Spot.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003edb.\u003cspan class=\"hljs-property\"\u003epets\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003efindOne\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;Spot\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;dog\u0026quot;\u003c/span\u003e });\n\u003c/code\u003e\u003c/pre\u003e\u003ch2\u003efind\u003c/h2\u003e\n\u003cp\u003eSo far we\u0026#39;ve only been looking at finding one record at time. If you want to find all documents that match your query, you\u0026#39;ll have to use find instead of findOne. Let\u0026#39;s try it.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003edb.\u003cspan class=\"hljs-property\"\u003epets\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003efind\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;dog\u0026quot;\u003c/span\u003e });\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNotice this only giving you twenty results. What MongoDB does by default is only hand you twenty results at a time in the form of what\u0026#39;s called an \u003cstrong\u003eiterator\u003c/strong\u003e or a \u003cstrong\u003ecursor\u003c/strong\u003e. An iterator will give you twenty records at a time and allow you to iterate over your results. Frequently this is a useful pattern because you could in theory want to iterate over your whole collection and this allows you to do it piece by piece.\u003c/p\u003e\n\u003cp\u003eTry iterating now. Run this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eit\nit\nit\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eYou\u0026#39;ll notice that you\u0026#39;re getting twenty different records each time. \u003ccode\u003eit\u003c/code\u003e will tell your iterator that you want it to iterate again on the last iterator you queried for.\u003c/p\u003e\n\u003ch2\u003ecount, limit, and toArray\u003c/h2\u003e\n\u003cp\u003eOkay, so let\u0026#39;s try this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003edb.\u003cspan class=\"hljs-property\"\u003epets\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003ecount\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;dog\u0026quot;\u003c/span\u003e }); \u003cspan class=\"hljs-comment\"\u003e// probably pretty big number\u003c/span\u003e\ndb.\u003cspan class=\"hljs-property\"\u003epets\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003efind\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;dog\u0026quot;\u003c/span\u003e }).\u003cspan class=\"hljs-title function_\"\u003elimit\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e40\u003c/span\u003e);\nit; \u003cspan class=\"hljs-comment\"\u003e// after this the cursor will end\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003e\u003ccode\u003ecount\u003c/code\u003e lets you figure our how many of something there are. \u003ccode\u003elimit\u003c/code\u003e lets the cursor know when you want to stop. But what if you just want to get everything all at once? Try \u003ccode\u003etoArray\u003c/code\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003edb.\u003cspan class=\"hljs-property\"\u003epets\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003efind\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;dog\u0026quot;\u003c/span\u003e }).\u003cspan class=\"hljs-title function_\"\u003elimit\u003c/span\u003e(\u003cspan class=\"hljs-number\"\u003e40\u003c/span\u003e).\u003cspan class=\"hljs-title function_\"\u003etoArray\u003c/span\u003e();\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThis will just dump everything out into an array which is nice if you just want everything all at once. There\u0026#39;s a myriad of other things you can do that determine how the data is returned but you can find those fairly easily when you need them.\u003c/p\u003e\n\u003ch2\u003eQuery operators\u003c/h2\u003e\n\u003cp\u003eWhat if we wanted to find all senior-aged cats in our data set? MongoDB will let you do that! Let\u0026#39;s try this\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003edb.\u003cspan class=\"hljs-property\"\u003epets\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003ecount\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;cat\u0026quot;\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eage\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003e$gt\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e12\u003c/span\u003e } });\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eNote you can use these \u003ca href=\"%5Bgeo%5D:\"\u003equery operators\u003c/a\u003e anywhere you\u0026#39;re providing a query e.g. findOne, find, etc. The ones you\u0026#39;re primarily going to be interested in are\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e$gt - greater than\u003c/li\u003e\n\u003cli\u003e$gte - greater than or equal to\u003c/li\u003e\n\u003cli\u003e$lt - less than\u003c/li\u003e\n\u003cli\u003e$lte - less than or equal to\u003c/li\u003e\n\u003cli\u003e$eq - equals (usually not necessary)\u003c/li\u003e\n\u003cli\u003e$ne - not equals\u003c/li\u003e\n\u003cli\u003e$in - has the value in the array (MongoDB can store arrays and objects too!)\u003c/li\u003e\n\u003cli\u003e$nin - does not have the value in the array\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eIf you wanted to see all Fidos that are not dogs you could do:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003edb.\u003cspan class=\"hljs-property\"\u003epets\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003efind\u003c/span\u003e({\n  \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003e$ne\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;dog\u0026quot;\u003c/span\u003e },\n  \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;Fido\u0026quot;\u003c/span\u003e,\n});\n\u003c/code\u003e\u003c/pre\u003e\u003ch2\u003eLogical operators\u003c/h2\u003e\n\u003cp\u003eTaking it a step further, you can do logical operators as well. Let\u0026#39;s say you want to find birds between 4 and 8 years old\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003edb.\u003cspan class=\"hljs-property\"\u003epets\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003efind\u003c/span\u003e({\n  \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;bird\u0026quot;\u003c/span\u003e,\n  \u003cspan class=\"hljs-attr\"\u003e$and\u003c/span\u003e: [{ \u003cspan class=\"hljs-attr\"\u003eage\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003e$gte\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e } }, { \u003cspan class=\"hljs-attr\"\u003eage\u003c/span\u003e: { \u003cspan class=\"hljs-attr\"\u003e$lte\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e } }],\n});\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eYou also have $or, $nor, and $not available to you. Keep in mind that $not and $ne are different. The former is the logical operator and the latter is \u003ccode\u003e!==\u003c/code\u003e.\u003c/p\u003e\n\u003ch2\u003eSpecial operators\u003c/h2\u003e\n\u003cp\u003eThese won\u0026#39;t be useful now but I just wanted to let you know that you can query by type (see if something is a number, array, object, etc.) with $type and you can query if a document has a field or not with $exists.\u003c/p\u003e\n\u003cp\u003eThere\u0026#39;s a bunch more you can do too. MongoDB even has [geospatial operators][geo] so you can query if two points on the globe are close to each other!\u003c/p\u003e\n\u003ch2\u003eSorts\u003c/h2\u003e\n\u003cp\u003eFrequently you\u0026#39;ll need to do different sorts with your queries. Let\u0026#39;s say you\u0026#39;re making a search page for these pets (foreshadowing what we\u0026#39;re about to do!) Maybe the person who searching on your website is a kind soul and looking to adopt some senior dogs. They could say sort by age, descending.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003edb.\u003cspan class=\"hljs-property\"\u003epets\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003efind\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;dog\u0026quot;\u003c/span\u003e }).\u003cspan class=\"hljs-title function_\"\u003esort\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003eage\u003c/span\u003e: -\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e });\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe \u003ccode\u003e-1\u003c/code\u003e means descending and, as you probably guessed, 1 means ascending.\u003c/p\u003e\n\u003ch2\u003eProjections\u003c/h2\u003e\n\u003cp\u003eLastly, to conclude our little lesson querying (there\u0026#39;s still a lot more you can do), let\u0026#39;s talk about projections. The simplest way to use projections is just to limit which fields you return.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003edb.\u003cspan class=\"hljs-property\"\u003epets\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003efind\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;dog\u0026quot;\u003c/span\u003e }, { \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ebreed\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e });\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eThe \u003ccode\u003e1\u003c/code\u003e means \u0026quot;definitely include this\u0026quot;. In thise case, we\u0026#39;re only including name and breed. If you leave something out (like age) then it doesn\u0026#39;t come along for the ride. Notice that \u003ccode\u003e_id\u003c/code\u003e does come along. If you don\u0026#39;t want that, you have to explictly exclude it\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003edb.\u003cspan class=\"hljs-property\"\u003epets\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003efind\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;dog\u0026quot;\u003c/span\u003e }, { \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ebreed\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003e_id\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e });\ndb.\u003cspan class=\"hljs-property\"\u003epets\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003efind\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;dog\u0026quot;\u003c/span\u003e }, { \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ebreed\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003e_id\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003efalse\u003c/span\u003e }); \u003cspan class=\"hljs-comment\"\u003e// note that true and false work too\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003cp\u003eIt also works to just exclude fields which means include everything I haven\u0026#39;t excluded\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003edb.\u003cspan class=\"hljs-property\"\u003epets\u003c/span\u003e.\u003cspan class=\"hljs-title function_\"\u003efind\u003c/span\u003e({ \u003cspan class=\"hljs-attr\"\u003etype\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e\u0026quot;dog\u0026quot;\u003c/span\u003e }, { \u003cspan class=\"hljs-attr\"\u003e_id\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e });\n\u003c/code\u003e\u003c/pre\u003e","markdown":"\nSo now that we've put a lot of documents into our database, it's time to query our database to get information out of it. There are a variety of reasons and methods you can query a database. You could be querying a database to get one a specific record, like if you're querying for a user object to show a profile page, or you could be querying for a bunch of things at once, like if a user was searching for pets and you wanted to show five results.\n\n## findOne\n\nLet's start with basic querying. Run this in the console.\n\n```javascript\ndb.pets.findOne();\n```\n\nThis will go out and find the first item in the database that matches your query and return that. In this case we didn't give it a query which is the same as saying \"give me anything.\" You'll probably get back the first item you inserted into your database which in my case is going to be a Havanese dog named Luna.\n\nOkay, so let's we want to find the 1337 item we put in the database. Try this:\n\n```javascript\ndb.pets.findOne({ index: 1337 });\n```\n\nThis will find you one item (of which there is only one anyway) where the index is equal to 1337. Okay, one more, let's find one where it's a dog named Spot.\n\n```javascript\ndb.pets.findOne({ name: \"Spot\", type: \"dog\" });\n```\n\n## find\n\nSo far we've only been looking at finding one record at time. If you want to find all documents that match your query, you'll have to use find instead of findOne. Let's try it.\n\n```javascript\ndb.pets.find({ type: \"dog\" });\n```\n\nNotice this only giving you twenty results. What MongoDB does by default is only hand you twenty results at a time in the form of what's called an **iterator** or a **cursor**. An iterator will give you twenty records at a time and allow you to iterate over your results. Frequently this is a useful pattern because you could in theory want to iterate over your whole collection and this allows you to do it piece by piece.\n\nTry iterating now. Run this:\n\n```\nit\nit\nit\n```\n\nYou'll notice that you're getting twenty different records each time. `it` will tell your iterator that you want it to iterate again on the last iterator you queried for.\n\n## count, limit, and toArray\n\nOkay, so let's try this:\n\n```javascript\ndb.pets.count({ type: \"dog\" }); // probably pretty big number\ndb.pets.find({ type: \"dog\" }).limit(40);\nit; // after this the cursor will end\n```\n\n`count` lets you figure our how many of something there are. `limit` lets the cursor know when you want to stop. But what if you just want to get everything all at once? Try `toArray`\n\n```javascript\ndb.pets.find({ type: \"dog\" }).limit(40).toArray();\n```\n\nThis will just dump everything out into an array which is nice if you just want everything all at once. There's a myriad of other things you can do that determine how the data is returned but you can find those fairly easily when you need them.\n\n## Query operators\n\nWhat if we wanted to find all senior-aged cats in our data set? MongoDB will let you do that! Let's try this\n\n```javascript\ndb.pets.count({ type: \"cat\", age: { $gt: 12 } });\n```\n\nNote you can use these [query operators][operators] anywhere you're providing a query e.g. findOne, find, etc. The ones you're primarily going to be interested in are\n\n- \\$gt - greater than\n- \\$gte - greater than or equal to\n- \\$lt - less than\n- \\$lte - less than or equal to\n- \\$eq - equals (usually not necessary)\n- \\$ne - not equals\n- \\$in - has the value in the array (MongoDB can store arrays and objects too!)\n- \\$nin - does not have the value in the array\n\nIf you wanted to see all Fidos that are not dogs you could do:\n\n```javascript\ndb.pets.find({\n  type: { $ne: \"dog\" },\n  name: \"Fido\",\n});\n```\n\n## Logical operators\n\nTaking it a step further, you can do logical operators as well. Let's say you want to find birds between 4 and 8 years old\n\n```javascript\ndb.pets.find({\n  type: \"bird\",\n  $and: [{ age: { $gte: 4 } }, { age: { $lte: 8 } }],\n});\n```\n\nYou also have $or, $nor, and \\$not available to you. Keep in mind that $not and $ne are different. The former is the logical operator and the latter is `!==`.\n\n## Special operators\n\nThese won't be useful now but I just wanted to let you know that you can query by type (see if something is a number, array, object, etc.) with $type and you can query if a document has a field or not with $exists.\n\nThere's a bunch more you can do too. MongoDB even has [geospatial operators][geo] so you can query if two points on the globe are close to each other!\n\n## Sorts\n\nFrequently you'll need to do different sorts with your queries. Let's say you're making a search page for these pets (foreshadowing what we're about to do!) Maybe the person who searching on your website is a kind soul and looking to adopt some senior dogs. They could say sort by age, descending.\n\n```javascript\ndb.pets.find({ type: \"dog\" }).sort({ age: -1 });\n```\n\nThe `-1` means descending and, as you probably guessed, 1 means ascending.\n\n## Projections\n\nLastly, to conclude our little lesson querying (there's still a lot more you can do), let's talk about projections. The simplest way to use projections is just to limit which fields you return.\n\n```javascript\ndb.pets.find({ type: \"dog\" }, { name: 1, breed: 1 });\n```\n\nThe `1` means \"definitely include this\". In thise case, we're only including name and breed. If you leave something out (like age) then it doesn't come along for the ride. Notice that `_id` does come along. If you don't want that, you have to explictly exclude it\n\n```javascript\ndb.pets.find({ type: \"dog\" }, { name: 1, breed: 1, _id: 0 });\ndb.pets.find({ type: \"dog\" }, { name: true, breed: true, _id: false }); // note that true and false work too\n```\n\nIt also works to just exclude fields which means include everything I haven't excluded\n\n```javascript\ndb.pets.find({ type: \"dog\" }, { _id: 0 });\n```\n\n[operators]:\n[geo]:\n","slug":"querying-mongodb","title":"Querying Mongodb","section":"Nosql","icon":"info-circle","filePath":"/home/runner/work/complete-intro-to-databases-v2/complete-intro-to-databases-v2/lessons/02-nosql/C-querying-mongodb.md","nextSlug":"/lessons/nosql/updating-mongodb","prevSlug":"/lessons/nosql/mongodb"}},"__N_SSG":true},"page":"/lessons/[section]/[slug]","query":{"section":"nosql","slug":"querying-mongodb"},"buildId":"Ogv8p-BwCHRQ1PzRpAU9u","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>